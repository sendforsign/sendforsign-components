import{j as e,F as z,S as v,A as N,a as S,C as O,R as G,b as T,B as A,c as V,f as Y,T as q,e as H,g as J,h as Q}from"./index.esm-BQi3gta5.js";import{r as a}from"./index-BsHCltJw.js";import{T as W,u as X}from"./use-save-params-d0meqd02.js";import{T as Z}from"./template-editor-BJd0KovC.js";import{M as $}from"./index-Ba-Zhihp.js";import"./index-BY6ttnmU.js";import"./_commonjsHelpers-BosuxZz1.js";import"./_commonjs-dynamic-modules-TwCWkOBp.js";import"./index-Dk74W0Oi.js";import"./tiny-invariant-CopsF_GD.js";import"./throttle-BZvPllO6.js";import"./isSymbol-DB5r9LRl.js";const P=a.createContext(void 0),ee=()=>{const t=a.useContext(P);if(!t)throw new Error("useTemplateListContext must be used inside the ListProvider");return t},te=()=>{const{apiKey:t,templateKey:r,setTemplateKey:p,clientKey:n,userKey:o,templateModal:f,setTemplateModal:m,refreshTemplate:c,setRefreshTemplate:u}=ee(),y=()=>{p(""),u(c+1),m(!1)};return console.log("templateKey, clientKey, userKey",r,n,o),e($,{open:f,centered:!0,onCancel:y,closable:!0,footer:e(z,{}),width:1200,children:e(v,{direction:"vertical",size:"large",style:{display:"flex"},children:e(Z,{apiKey:t,clientKey:n,userKey:o,templateKey:r})})})};var ae={};const _=({apiKey:t,clientKey:r,isModal:p,userKey:n})=>{if(!t&&!ae.REACT_APP_SENDFORSIGN_KEY)throw new Error("Missing Publishable Key");const{setParam:o,getParam:f}=X(),[m,c]=a.useState(""),[u,y]=a.useState(r),[w,I]=a.useState(n),[L,h]=a.useState(t),[k,g]=a.useState(!1),[K,R]=a.useState(0),[j,F]=a.useState([]),{Title:B}=q,C=i=>{debugger;c(i),o("templateKey",i),p&&(g(!0),o("openModalTemplate",!0))},D=[{title:"Template name",dataIndex:"name",render:(i,d)=>e(A,{type:"link",onClick:()=>{C(d.key?d.key:"")},children:d.name})},{title:"Created at",dataIndex:"createdAt"},{title:"Modified at",dataIndex:"changedAt"},{title:"Created by",dataIndex:"createdBy"}];return a.useEffect(()=>{h(t)},[t]),a.useEffect(()=>{let i={data:{action:N.LIST,clientKey:r,userKey:n}};(async()=>{await H.post(J+Q.TEMPLATE,i,{headers:{Accept:"application/vnd.api+json","Content-Type":"application/vnd.api+json","x-sendforsign-key":t},responseType:"json"}).then(x=>{console.log("editor list",x);let U=x.data.templates.map(s=>({key:s.templateKey,name:s.name?s.name:"Empty name",createdAt:s.createTime?s.createTime.toString():new Date().toString(),changedAt:s.changeTime?s.changeTime.toString():new Date().toString()}));F(U)})})()},[K]),S(P.Provider,{value:{templateModal:k,setTemplateModal:g,templateKey:m,setTemplateKey:c,clientKey:u,setClientKey:y,userKey:w,setUserKey:I,refreshTemplate:K,setRefreshTemplate:R,apiKey:L,setApiKey:h},children:[e(v,{direction:"vertical",size:16,style:{display:"flex"},children:e(O,{children:e(W,{columns:D,dataSource:j,title:()=>S(G,{children:[e(T,{children:e(B,{level:3,style:{margin:"0",display:"flex",textAlign:"center"},children:"Templates"})}),e(T,{flex:"auto"}),e(T,{children:e(A,{type:"primary",icon:e(V,{icon:Y}),onClick:()=>{C("")},children:"Add template"})})]})})})}),e(te,{})]})},Te={component:_,title:"Marbella/TemplateList",argTypes:{}},l=t=>e(_,{"data-testId":"InputField-id",...t});l.args={apiKey:"re_api_key",clientKey:"b817e635-ee26-40f9-ba82-f4612077a2f4",userKey:"",isModal:!0};var E,M,b;l.parameters={...l.parameters,docs:{...(E=l.parameters)==null?void 0:E.docs,source:{originalSource:"args => <TemplateList data-testId='InputField-id' {...args} />",...(b=(M=l.parameters)==null?void 0:M.docs)==null?void 0:b.source}}};const fe=["Primary"];export{l as Primary,fe as __namedExportsOrder,Te as default};
