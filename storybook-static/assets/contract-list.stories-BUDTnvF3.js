import{j as t,F as H,S as j,A as J,a as A,C as Q,R as W,b as S,B as E,c as X,f as Z,T as $,d as tt,e as _,g as b,h as w}from"./index.esm-BQi3gta5.js";import{r as a}from"./index-BsHCltJw.js";import{T as et,u as at}from"./use-save-params-d0meqd02.js";import{C as st}from"./contract-editor-kFgnaqvB.js";import{M as rt}from"./index-Ba-Zhihp.js";import"./index-BY6ttnmU.js";import"./_commonjsHelpers-BosuxZz1.js";import"./_commonjs-dynamic-modules-TwCWkOBp.js";import"./index-Dk74W0Oi.js";import"./tiny-invariant-CopsF_GD.js";import"./throttle-BZvPllO6.js";import"./isSymbol-DB5r9LRl.js";import"./index-BQ5IbGbl.js";import"./inheritsLoose-MVK87o0N.js";const k=a.createContext(void 0),nt=()=>{const e=a.useContext(k);if(!e)throw new Error("useContractListContext must be used inside the ListProvider");return e},ot=({id:e})=>{const{contractKey:d,contractModal:y,apiKey:u,clientKey:p,userKey:c,setContractKey:m,setContractModal:C,refreshContracts:f,setRefreshContracts:h}=nt();return t(rt,{open:y,centered:!0,onCancel:()=>{m(""),C(!1),h(f+1)},closable:!0,footer:t(H,{}),width:1200,children:t(j,{direction:"vertical",size:"large",style:{display:"flex"},children:t(st,{id:e,apiKey:u,clientKey:p,userKey:c,contractKey:d})})})};var it={};const L=({apiKey:e,clientKey:d,isModal:y,userKey:u})=>{if(!e&&!it.REACT_APP_SENDFORSIGN_KEY)throw new Error("Missing Publishable Key");const{setParam:p}=at(),[c,m]=a.useState(""),[C,f]=a.useState(d),[h,g]=a.useState(u),[R,x]=a.useState(e),[D,K]=a.useState(!1),[F,U]=a.useState(!1),[T,N]=a.useState(0),[B,O]=a.useState([]),[z,V]=a.useState([]),{Title:G}=$,v=n=>{m(n),p("contractKey",n),y&&(K(!0),p("openModal",!0))},Y=[{title:"Document name",dataIndex:"name",render:(n,s)=>t(E,{type:"link",onClick:()=>{debugger;v(s.key?s.key:"")},children:s.name})},{title:"Status",dataIndex:"status",render:(n,s)=>{let o=z.find(r=>r.name===s.status);return t(tt,{color:o&&o.color?o.color:"purple",children:s.status?s.status:"Draft"},s.status?s.status:"Draft")}},{title:"Created at",dataIndex:"createdAt"},{title:"Created by",dataIndex:"createdBy"}];return a.useEffect(()=>{x(e)},[e]),a.useEffect(()=>{let n={data:{action:J.LIST,clientKey:d,userKey:u}};(async()=>{let o=[];await _.get(b+w.EVENT_STATUS,{headers:{Accept:"application/vnd.api+json","Content-Type":"application/vnd.api+json","x-sendforsign-key":e},responseType:"json"}).then(r=>{console.log("getEventStatus read",r),o=r.data,V(o)}),await _.post(b+w.CONTRACT,n,{headers:{Accept:"application/vnd.api+json","Content-Type":"application/vnd.api+json","x-sendforsign-key":e},responseType:"json"}).then(r=>{console.log("editor list",r);let q=r.data.contracts.map(i=>({key:i.contractKey,name:i.name?i.name:"Empty name",status:i.status,createdAt:i.createTime?i.createTime.toString():new Date().toString()}));O(q)})})()},[T]),A(k.Provider,{value:{contractModal:D,setContractModal:K,contractKey:c,setContractKey:m,clientKey:C,setClientKey:f,userKey:h,setUserKey:g,refreshContracts:T,setRefreshContracts:N,needUpdate:F,setNeedUpdate:U,apiKey:R,setApiKey:x},children:[t(j,{direction:"vertical",size:16,style:{display:"flex"},children:t(Q,{children:t(et,{columns:Y,dataSource:B,title:()=>A(W,{children:[t(S,{children:t(G,{level:3,style:{margin:"0",display:"flex",textAlign:"center"},children:"Documents"})}),t(S,{flex:"auto"}),t(S,{children:t(E,{type:"primary",icon:t(X,{icon:Z}),onClick:()=>{v("")},children:"Add document"})})]})})})}),t(ot,{id:c||"New contract"})]})},Tt={component:L,title:"Marbella/ContractList",argTypes:{}},l=e=>t(L,{"data-testId":"InputField-id",...e});l.args={apiKey:"re_api_key",clientKey:"b817e635-ee26-40f9-ba82-f4612077a2f4",userKey:"",isModal:!0};var I,M,P;l.parameters={...l.parameters,docs:{...(I=l.parameters)==null?void 0:I.docs,source:{originalSource:"args => <ContractList data-testId='InputField-id' {...args} />",...(P=(M=l.parameters)==null?void 0:M.docs)==null?void 0:P.source}}};const vt=["Primary"];export{l as Primary,vt as __namedExportsOrder,Tt as default};
